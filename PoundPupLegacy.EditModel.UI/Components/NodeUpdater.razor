@inherits ViewerBase
@typeparam TEditModel where TEditModel: class, Node
@inject IViewModelRetrieveService<TEditModel> editService

@code {

    [Parameter]
    [EditorRequired]
    public int UrlId { get; set; }

    protected TEditModel? Model { get; set; } 

    protected override async Task OnInitializedAsync()
    {
        Model = await editService.GetViewModelAsync(
            urlId: UrlId, 
            userId: UserId, 
            tenantId:TenantId);

        foreach (var tenant in Model!.NodeDetails.Tenants) {
            var tenantNode = Model!.NodeDetails.TenantNodeDetails.TenantNodes.FirstOrDefault(x => x is not null && x.TenantId == tenant.Id);
            tenant.TenantNode = tenantNode;
        }
    }

    public string Title => $"Update {Model?.NodeDetails.NodeTypeName}";
}
