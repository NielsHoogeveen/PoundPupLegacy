@using PoundPupLegacy.Services
@using PoundPupLegacy.ViewModel.Models
@inherits PagedViewer
@inject ISiteDataService siteDataService
@inject IUserService userService
@inject IFetchPollsService FetchPollsService

@if(Model is not null){
    <div class="articles">
        <div class="breadcrum">
            <span class="breadcrum-element">
                <a href="/home">home</a>
            </span>
        </div>
        <article>
        <div class="blog-teasers">
            @foreach (var entry in Model.Entries)
            {
                @if (!entry.HasBeenPublished)
                {
                    <div class="watermark">Unpublished</div>
                }
                <div class="blog-teaser">
                    <h2>
                        <a href="@entry.Path">@entry.Title</a>
                    </h2>
                    <LargeTextViewer Value="@entry.Text" />
                </div>
            }
        </div>
        </article>
        <Pager Model="Model" />
    </div>
}

@code {
    private Polls? Model { get; set; }

    const int NUMBER_OF_ENTRIES = 25;

    protected override async Task OnInitializedPagedAsync()
    {
        Model = await FetchPollsService.GetPolls(UserId, TenantId, NUMBER_OF_ENTRIES, PageNumber);
    }

}
